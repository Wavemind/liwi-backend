<div class="breadcrumb mb-4"><%= render_breadcrumbs %></div>

<h1><%= t('.title', name: @diagnostic.label) %></h1>

<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="home-tab" data-toggle="tab" href="#instances" role="tab" aria-controls="home" aria-selected="true"><%= t('.instances') %></a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="profile-tab" data-toggle="tab" href="#final_diagnostics" role="tab" aria-controls="profile" aria-selected="false"><%= t('.subtitle_final_diagnostics')  %> </a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="contact-tab" data-toggle="tab" href="#differential_conditions" role="tab" aria-controls="contact" aria-selected="false"><%= t('.differential_diagnostic_conditions') %></a>
  </li>
</ul>


<div class="tab-content mt-4 ml-4" id="diagnostic-table">
  <div class="tab-pane fade show active" id="instances" role="tabpanel" aria-labelledby="home-tab">
    <h3><%= t('.instances') %></h3>

    <div class="row">
      <div class="col">
        <%= simple_form_for @instance, url: diagnostic_instances_url(@diagnostic), method: :post do |f| %>
          <div class="row">
            <div class="col">
              <%= f.association :node, collection: (@algorithm.nodes.where.not(id: @diagnostic.components.select(:node_id)) + FinalDiagnostic.where(diagnostic_id: params[:id])).flatten.sort_by(&:reference), label_method: :reference_label, prompt: t('select'), label: false %>
            </div>
            <div class="col">
              <%= f.submit t('add'), class: 'btn btn-primary' %>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <%= render 'instances/table' %>
  </div>
  <div class="tab-pane fade" id="final_diagnostics" role="tabpanel" aria-labelledby="final_diagnostics-tab">
    <h3><%= t('.subtitle_final_diagnostics') %></h3>

    <%= link_to new_algorithm_version_diagnostic_final_diagnostic_url(@algorithm, @version, @diagnostic) do %>
      <button type="button" class="btn btn-outline-secondary"><%= t('add') %></button>
    <% end %>

    <%= render 'final_diagnostics/table' %>
  </div>
  <div class="tab-pane fade" id="differential_conditions" role="tabpanel" aria-labelledby="differential_conditions-tab">
    <h3><%= t('.differential_diagnostic_conditions') %></h3>

    <%= render 'conditions/differential_table' %>
  </div>
</div>



